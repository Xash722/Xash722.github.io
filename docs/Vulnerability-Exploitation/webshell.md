---
title: Webshell
parent: Vulnerability Exploitation
nav_order: 5
---

# Webshell
<br>
웹 서버에서 원격으로 명령을 수행할 수 있도록 만든 악성 코드 또는 스크립트
<br>

```<?php echo shell_exec($_GET['cmd']); ?>```
{: .fs-6 .text-center}
간단한 웹쉘 만드는 방법으로는 위의 코드가 있지만 조금은 더 현실적인 웹 쉘을 이용해보자

## WSO-webshell
<br>

![WSO webshell](\assets\images\webshell\ws1_wso.png)
WSO webshell
{: .text-center}

WSO-webshell의 기능으로는
- 비밀번호를 통한 로그인 시스템
- 파일 관리(업로드, 다운로드, 삭제, 편집)
- 콘솔
- 자가 삭제제
- 데이터베이스 접근
- 브루트 포스
- 백도어 설치

등의 기능들이 있다.

![readme](\assets\images\webshell\ws2_readmepw.png)
{: .text-center}
readme
{: .text-center}
readme 파일을 읽어보면 md5로 해시처리 된 비밀번호로 설정된다는 것을 알 수 있다.
<br>

![password](\assets\images\webshell\ws3_pw.png)
{: .text-center}
패스워드
{: .text-center}

![change password](\assets\images\webshell\ws4_changepw.png)
{: .text-center}
패스워드 변경
{: .text-center}
<br>
따라서 패스워드를 정하고 md5로 해시를 한 후 로컬 시스템에 저장한 wso.php 파일에 해시된 비밀번호를 넣는다.
그 다음 탐지 회피, 은폐를 위해 무작위 파일명으로 변경한 후 타겟 서버에 올린다.
<br><br>

![upload webshell](\assets\images\webshell\ws5_upload.png)
웹 쉘 업로드
{: .text-center}

![WSO webshell](\assets\images\webshell\ws6_uploadsuccess.png)
업로드 성공
{: .text-center}

![WSO webshell 로그인](\assets\images\webshell\ws7_wsoshell.png)
로그인 성공
{: .text-center}

이제 비밀번호를 통한 로그인 시스템, 파일 관리(업로드, 다운로드, 삭제, 편집), 콘솔, 자가 삭제, 데이터베이스 접근, 브루트 포스, 백도어 설치 등의 
기능이 있는 WSO webshell을 사용해 후속 공격을 진행하면 된다.

---------------------------
## 번외

## 기본적인 웹 쉘의 패킷

wireshark를 통해 웹 쉘의 HTTP stream을 확인해보자

![webshell http stream](\assets\images\webshell\ws8_패킷_1.png)
webshell HTTP stream
{: .text-center}

요청과 응답 부분이 그대로 평문으로 노출되기 때문에 공격 탐지가 매우 쉬워진다.

해당 문제를 보완하기 위한 방법으로는 gzip, base64, XOR, ROT13 등의 난독화를 2중 3중으로 사용해 탐지를 어렵게 만드는 방법이 있다.

